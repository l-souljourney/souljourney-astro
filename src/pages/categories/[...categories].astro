---
import { getCategoriesList } from "@/utils/getArchive";
import { getCollection } from "astro:content";
import { getCategoryDisplayName, getAllCategoryPaths } from "@/utils/categoryMapping";
export async function getStaticPaths(): Promise<any> {
	const allPosts = await getCollection("blog");
const zhPosts = allPosts.filter((post: any) => !post.id.startsWith('en/'));
	// 获取所有文章使用的分类
	const usedCategories = new Set(zhPosts.map((post: any) => post.data.categories));
	// 获取所有配置的分类
	const allCategories = getAllCategoryPaths();
	// 合并：文章分类 + 配置的分类（确保所有导航中的分类都有页面）
	const allPaths = new Set([...usedCategories, ...allCategories]);
	// 生成所有分类的页面路径
	return Array.from(allPaths).map((category: string) => ({ 
		params: { categories: category }, 
		props: { category } 
	}));
}
// 获取分类列表
const { categories } = Astro.params;
const articleList = await getCategoriesList(categories);
// 页面 Info
import SITE_CONFIG from "@/config";
const { Description } = SITE_CONFIG;
// 公共 Layout
import Layout from "@/layouts/Layout/Layout.astro";
// 文章列表组件
import Archive from "@/components/Archive/Archive.astro";
// 获取分类中文显示名称
const categoryDisplayName = getCategoryDisplayName(categories);
---

<Layout title={`分类 ${categoryDisplayName} 下的文章`} description={Description} activeNav={categories}>
	<Archive articleList={articleList} />
</Layout>
