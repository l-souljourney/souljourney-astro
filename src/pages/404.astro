---
import Layout from '@/layouts/Layout/Layout.astro';
import SITE_CONFIG from '@/config';
import { getLangFromUrl, useTranslations } from '@/i18n/utils';

export const prerender = true;

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const { Description } = SITE_CONFIG;

const title = t('404.title');
const desc = t('404.desc');
const backText = t('404.back');
const homeLink = lang === 'zh' ? '/' : '/en/';
---

<Layout title={title} description={Description}>
	<section class="flex flex-col items-center justify-center min-h-[50vh] text-center px-4">
		<h1 class="text-9xl font-bold text-primary mb-4">404</h1>
		<h2 class="text-2xl font-bold mb-4">{title}</h2>
		<p class="text-muted-foreground mb-8 text-lg">{desc}</p>
		<a href={homeLink} class="px-6 py-3 rounded-lg bg-primary text-primary-foreground hover:opacity-90 transition-opacity font-medium">
			{backText}
		</a>
	</section>
</Layout>

<script>
  // 客户端检测：如果 URL 包含 /en/，则强制显示英文 404 信息
  if (window.location.pathname.startsWith('/en/')) {
    const title = document.querySelector('h2');
    const desc = document.querySelector('p');
    const link = document.querySelector('a');
    
    if (title) title.textContent = 'Page Not Found';
    if (desc) desc.textContent = "Sorry, the page you looking for doesn't exist.";
    if (link) {
        link.textContent = 'Back to Home';
        link.href = '/en/';
    }
  }
</script>
