---
import config from "@/config";
import { Icon } from 'astro-icon/components';
import { getLangFromUrl, useTranslations } from '@/i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

// 计算版权年份
const startYear = new Date(config.CreateTime).getFullYear();
const currentYear = new Date().getFullYear();
const copyrightYear = config.Footer.copyright.showCurrentYear && startYear !== currentYear
  ? `${startYear}-${currentYear}`
  : `${startYear}`;
---

<footer class="w-full py-8 mt-6 bg-background border-t border-border text-muted-foreground transition-colors duration-300">
	<main class="container mx-auto flex flex-col items-center justify-center gap-4 px-4">
		<!-- 网站运行时间 -->
		<div class="flex items-center gap-2">
			<span class="inline-flex items-center h-6 bg-muted text-xs rounded-md overflow-hidden border border-border">
				<span class="px-1.5 flex items-center h-full bg-secondary text-secondary-foreground">
					<Icon name="shield-heart" class="w-3 h-3" />
				</span>
				<cite class="px-1.5 flex items-center h-full not-italic">{t('footer.running')}</cite>
				<em class="web_time px-1.5 flex items-center h-full not-italic bg-primary text-primary-foreground"></em>
			</span>
		</div>

		<!-- 统一徽章链接 -->
		<div class="flex flex-wrap items-center justify-center gap-2 max-w-3xl mx-auto">
			<!-- RSS 徽章 -->
			{config.Footer.socialLinks.map(link => (
				<a 
					href={link.url} 
					target="_blank" 
					title={t(link.title as any)}
					class="inline-flex items-center h-6 bg-muted text-xs rounded-md overflow-hidden border border-border hover:bg-accent transition-colors"
				>
					<span class="px-1.5 flex items-center h-full bg-secondary text-secondary-foreground">
						<Icon name={link.icon} class="w-3 h-3" />
					</span>
					<span class="px-1.5 flex items-center h-full not-italic">{link.label}</span>
				</a>
			))}
			
			<!-- 底部徽章 -->
			{config.Footer.badgeLinks.map(link => (
				<a 
					href={link.url} 
					target="_blank" 
					rel="noopener noreferrer"
					title={t(link.title as any)}
					class="inline-flex items-center h-6 bg-muted text-xs rounded-md overflow-hidden border border-border hover:bg-accent transition-colors"
				>
					<span class="px-1.5 flex items-center h-full bg-secondary text-secondary-foreground">
						<Icon name={link.icon} class="w-3 h-3" />
					</span>
					<span class="px-1.5 flex items-center h-full not-italic">{t(link.label as any)}</span>
				</a>
			))}
		</div>

		<!-- 版权信息 + Slogan -->
		<div class="text-xs text-muted-foreground">
			{t('footer.copyright')}
		</div>
	</main>
</footer>
